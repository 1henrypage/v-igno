# Training Configuration

run_name: "darcy_experiment"
device: "cuda"
artifact_root: "runs"
seed: 10086

problem:
  type: "darcy_flow_continuous"

stages:
  - foundation

# pretrained:
#   path: "/path/to/checkpoint.pt"

dgno:
  epochs: 1000
  batch_size: 100
  epoch_show: 100
  loss_weights:
    pde: 1.0
    data: 1.0
  optimizer:
    type: Adam
    lr: 0.001
  scheduler:
    type: Plateau
    patience: 50
    factor: 0.5

nf:
  epochs: 500
  batch_size: 100
  epoch_show: 100
  nf:
    dim: 64
    num_flows: 8
    hidden_dim: 128
    num_layers: 2
  optimizer:
    type: Adam
    lr: 0.001
  scheduler:
    type: Plateau
    patience: 50
    factor: 0.5

encoder:
  epochs: 1000
  batch_size: 100
  epoch_show: 100
  freeze_decoder: true
  freeze_nf: true
  optimizer:
    type: Adam
    lr: 0.0001
  scheduler:
    type: Plateau
    patience: 50
    factor: 0.5